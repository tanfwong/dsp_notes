

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6.6. FIR Filter Design &#8212; Foundations of DSP Notes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch6/firdesign';</script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.7. IIR Filter Design" href="iirdesign.html" />
    <link rel="prev" title="6.5. Linear-phase Filter" href="linphase.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Foundations of Digital Signal Processing
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch1/review.html">1. Review of discrete-time signals and systems</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch1/signals.html">1.1. Discrete-time signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch1/systems.html">1.2. Discrete-time systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch1/ztransform.html">1.3. <span class="math notranslate nohighlight">\(z\)</span>-Transform</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch2/fourier.html">2. Fourier (Frequency Domain) Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch2/dtft.html">2.1. Discrete-Time Fourier Transform (DTFT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/dtft_tables.html">2.2. DTFT properties and tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/dirac_periodic.html">2.3. Periodic Dirac delta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/dtft_dirac_exs.html">2.4. DTFTs of infinite-energy signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/fs.html">2.5. Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/ft.html">2.6. Continuous-Time Fourier Transform (FT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/dirac.html">2.7. Dirac delta and FTs of infinite-energy signals</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch3/samp.html">3. Sampling and Reconstruction</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch3/poisson.html">3.1. Poisson Sum Formula</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch3/sampthm.html">3.2. Sampling Theorem</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch4/tdft.html">4. Time-dependent Fourier Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch4/uncertainty.html">4.1. Uncertainty Principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch4/stft.html">4.2. Short-time DTFT</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch5/comp.html">5. Computation of Fourier Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch5/fsamp.html">5.1. Frequency-domain Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch5/dft.html">5.2. Discrete Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch5/fft.html">5.3. Fast Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch5/fil_fft.html">5.4. Linear Filtering with FFT</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="fildesign.html">6. Filter Design</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="freqresp.html">6.1. Frequency Response of LTI System</a></li>
<li class="toctree-l2"><a class="reference internal" href="pz.html">6.2. Pole-Zero Placement</a></li>
<li class="toctree-l2"><a class="reference internal" href="allpass.html">6.3. Allpass Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="minphase.html">6.4. Minimum-phase Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="linphase.html">6.5. Linear-phase Filter</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.6. FIR Filter Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="iirdesign.html">6.7. IIR Filter Design</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch7/multirate.html">7. Multi-rate Processing</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch7/down.html">7.1. Downsampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch7/interp.html">7.2. Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch7/rateconv.html">7.3. Rational Rate Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch7/mfilter.html">7.4. Multi-rate Filtering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">8. References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tanfwong/dsp_notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tanfwong/dsp_notes/issues/new?title=Issue%20on%20page%20%2Fch6/firdesign.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/ch6/firdesign.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>FIR Filter Design</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-specifications">6.6.1. Filter Specifications</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#design-by-windowing">6.6.2. Design by Windowing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equiripple-design-parks-mcclellan-algorithm">6.6.3. Equiripple Design - Parks-McClellan Algorithm</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="fir-filter-design">
<span id="sec-firdesign"></span><h1><span class="section-number">6.6. </span>FIR Filter Design<a class="headerlink" href="#fir-filter-design" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>We discuss two common approaches to design FIR filters that
approximate the frequency responses of the ideal filters. We focus
on the design of lowpass filter. The design approaches extend almost
trivially to other types of filters. One may also use the frequency
transformation methods in <a class="reference internal" href="linphase.html#sec-freqtrans"><span class="std std-numref">Section 6.5.4</span></a> to convert the
lowpass filter to other types of filters.</p></li>
</ul>
<section id="filter-specifications">
<h2><span class="section-number">6.6.1. </span>Filter Specifications<a class="headerlink" href="#filter-specifications" title="Permalink to this headline">#</a></h2>
<ul>
<li><p>The first step in the filter design process is to specify in what
way we are to approximate the frequency response of an ideal lowpass
filter.</p></li>
<li><p>In the following discussion, we consider the specification of the
magnitude response shown in the figure below:</p>
<a class="reference internal image-reference" href="../_images/fspec.png"><img alt="Lowpass filter specification" class="align-center" src="../_images/fspec.png" style="width: 800px;" /></a>
<p>This specification is quantified by the quadruple
<span class="math notranslate nohighlight">\((\hat\omega_p, \hat\omega_s, \delta_1, \delta_2)\)</span>.</p>
</li>
<li><p>For the phase response, we impose the restriction that the group
delay of the filter must be a constant. That is, the filter must be
a generalized linear-phase FIR filter.</p></li>
</ul>
</section>
<section id="design-by-windowing">
<h2><span class="section-number">6.6.2. </span>Design by Windowing<a class="headerlink" href="#design-by-windowing" title="Permalink to this headline">#</a></h2>
<ul>
<li><p><strong>Design Procedure</strong>:</p>
<ol class="arabic simple">
<li><p>Pick a window <span class="math notranslate nohighlight">\(w[n]\)</span> of length <span class="math notranslate nohighlight">\(L=M+1\)</span> from the <a class="reference internal" href="../ch4/stft.html#tab-windows"><span class="std std-ref">table</span></a> in <a class="reference internal" href="../ch4/stft.html#sec-stft"><span class="std std-numref">Section 4.2</span></a>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(H_d(e^{j\hat\omega})\)</span> be the desired frequency
response. e.g., that of an ideal lowpass filter. Take the inverse
DTFT of <span class="math notranslate nohighlight">\(H_d(e^{j\hat\omega})\)</span> to obtain the desired impulse
response <span class="math notranslate nohighlight">\(h_d[n]\)</span>. Time-shift <span class="math notranslate nohighlight">\(h_d[n]\)</span>, if necessary, to make
<span class="math notranslate nohighlight">\(h_d[n]\)</span> symmetric (antisymmetric), i.e., <span class="math notranslate nohighlight">\(h_d[M-n] = h_d[n]\)</span>
(<span class="math notranslate nohighlight">\(h_d[M-n] = -h_d[n]\)</span>) for <span class="math notranslate nohighlight">\(n=0,1,\ldots,M\)</span>.</p></li>
<li><p>Apply the window to <span class="math notranslate nohighlight">\(h_d[n]\)</span> to generate the FIR impulse response
<span class="math notranslate nohighlight">\(h[n] = w[n] h_d[n]\)</span> of order <span class="math notranslate nohighlight">\(M\)</span>.</p></li>
<li><p>Calculate the magnitude response <span class="math notranslate nohighlight">\(|H(e^{j\hat\omega})|\)</span> of <span class="math notranslate nohighlight">\(h[n]\)</span>
to check whether the specification <span class="math notranslate nohighlight">\((\hat\omega_p, \hat\omega_s,
\delta_1, \delta_2)\)</span> is met.</p>
<ul class="simple">
<li><p>If yes, terminate and output <span class="math notranslate nohighlight">\(h[n]\)</span>.</p></li>
<li><p>If no, increment <span class="math notranslate nohighlight">\(M\)</span> and/or change other window parameters and
go back to step 2.</p></li>
</ul>
</li>
</ol>
</li>
<li><p>Note that every window <span class="math notranslate nohighlight">\(w[n]\)</span> listed in the <a class="reference internal" href="../ch4/stft.html#tab-windows"><span class="std std-ref">table</span></a> in <a class="reference internal" href="../ch4/stft.html#sec-stft"><span class="std std-numref">Section 4.2</span></a> is symmetric. As a result, if
<span class="math notranslate nohighlight">\(h_d[n]\)</span> is symmetric (antisymmetric), then <span class="math notranslate nohighlight">\(h[n]\)</span> will be symmetric
(antisymmetric). That is, the filter <span class="math notranslate nohighlight">\(h[n]\)</span> obtained will be a
generalized linear-phase FIR filter. For lowpass filter design, we
want <span class="math notranslate nohighlight">\(h[n]\)</span> to be symmetric (types 1 &amp; 2).</p></li>
<li><p>By the multiplication property of DTFT,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  H(e^{j\hat\omega}) = \frac{1}{2\pi} \int_{-\pi}^{\pi} H_d(e^{j\theta})
  W(e^{j(\hat\omega - \theta)}) \, d\theta.
  \end{equation*}\]</div>
<p>Pictorially, the DTFT <span class="math notranslate nohighlight">\(W(e^{j\hat\omega})\)</span> of the window <span class="math notranslate nohighlight">\(w[n]\)</span>
smooths out any abrupt transitions in <span class="math notranslate nohighlight">\(H_d(e^{j\hat\omega})\)</span> and
causes <strong>ripples</strong> in the passband and stopband.  These effects
become less prominent as the window length <span class="math notranslate nohighlight">\(L\)</span> (order <span class="math notranslate nohighlight">\(M\)</span>)
increases. The choice between different windows often amounts to a
tradeoff between a wider transition band and smaller <span class="math notranslate nohighlight">\(\delta_1\)</span> and
<span class="math notranslate nohighlight">\(\delta_2\)</span>.</p>
</li>
<li><p>For the Kaiser window, extensive numerical studies have been
performed to obtain empirical formulas for good choices of <span class="math notranslate nohighlight">\(M\)</span> and
<span class="math notranslate nohighlight">\(\beta\)</span> in order to satisfy the design specification <span class="math notranslate nohighlight">\((\hat\omega_p,
\hat\omega_p + \Delta\hat\omega, \delta, \delta)\)</span>
(see <span id="id1">[<a class="reference internal" href="../refs.html#id5" title="Alan Oppenheim and Ronald Schafer. Discrete-Time Signal Processing. Prentice Hall, 3rd edition, 2010.">OS10</a>]</span> Chapter 7 for details):</p>
<div class="math notranslate nohighlight" id="equation-e-kaiserord">
<span class="eqno">(6.10)<a class="headerlink" href="#equation-e-kaiserord" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{align}
\beta 
&amp;= 
\begin{cases}
0.1102 (D - 8.7) &amp; \text{if } D&gt;50
\\
0.5842(D-21)^{0.4} + 0.07886 (D-21) &amp; \text{if } 21 \leq D \leq 50
\\
0 &amp; \text{if } D &lt; 21
\end{cases}
\\
M 
&amp;= 
\frac{D-7.95}{2.285 \Delta\hat\omega}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(D = -20\log_{10} \delta\)</span>. As a result, one may use
<a class="reference internal" href="#equation-e-kaiserord">(6.10)</a> as an initial choice for step 1 in the design
procedure above.</p>
</li>
<li><p><strong>MATLAB Example 1</strong>:</p>
<p>The objective is to design a lowpass generalized linear-phase FIR
filter with the specification <span class="math notranslate nohighlight">\((0.3\pi, 0.35\pi, 0.01, 0.001)\)</span>. We
use the Kaiser window and <a class="reference internal" href="#equation-e-kaiserord">(6.10)</a> to select <span class="math notranslate nohighlight">\(M\)</span> and
<span class="math notranslate nohighlight">\(\beta\)</span>. One may use the MATLAB function <code class="docutils literal notranslate"><span class="pre">kaiserord</span></code> to calculate
the choices of <span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> given by <a class="reference internal" href="#equation-e-kaiserord">(6.10)</a>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">wc</span><span class="p">,</span><span class="w"> </span><span class="nb">beta</span><span class="p">,</span><span class="w"> </span><span class="n">ftype</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">kaiserord</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001</span><span class="p">])</span>

<span class="n">M</span><span class="w"> </span><span class="p">=</span>

<span class="w">      </span><span class="mi">146</span>

<span class="n">wc</span><span class="w"> </span><span class="p">=</span>

<span class="w">      </span><span class="mf">0.3250</span>

<span class="nb">beta</span><span class="w"> </span><span class="p">=</span>

<span class="w">      </span><span class="mf">5.6533</span>

<span class="n">ftype</span><span class="w"> </span><span class="p">=</span>

<span class="w">      </span><span class="s">&#39;low&#39;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The empirical formula <a class="reference internal" href="#equation-e-kaiserord">(6.10)</a> assumes
<span class="math notranslate nohighlight">\(\delta_1=\delta_2=\delta\)</span>. If the input tolerance vector to <code class="docutils literal notranslate"><span class="pre">kaiserord</span></code>
has elements of different values, such as in Example 1 above,
the minimum value is taken as <span class="math notranslate nohighlight">\(\delta\)</span>.</p>
</div>
<p>The estimated order is <span class="math notranslate nohighlight">\(M=146\)</span> (a type-1 filter).
Set the desired frequency response to be that of an ideal
lowpass filter, i.e., <span class="math notranslate nohighlight">\(H_d(e^{j\hat\omega}) = \begin{cases}
e^{-j\hat\omega \frac{M}{2}} &amp; \text{if } |\hat\omega| \leq 0.325\pi \\
0 &amp; \text{if } 0.325\pi &lt; |\hat\omega| \leq \pi.
\end{cases}\)</span> Taking inverse DTFT gives <span class="math notranslate nohighlight">\(\displaystyle h_d[n] =
\frac{\sin(0.325\pi (n- \frac{M}{2}))}{\pi
(n-\frac{M}{2})}\)</span>, which is clearly symmetric. Next, we apply the Kaiser
window to obtain the target type-1 or -2 filter <span class="math notranslate nohighlight">\(h[n]\)</span>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">M</span><span class="p">];</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">hd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="mf">0.325</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">M</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">./</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">M</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">pi</span><span class="p">;</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">hd</span><span class="p">(</span><span class="n">M</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.325</span><span class="p">;</span><span class="w"> </span><span class="c">%Need this only when M is even</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">h1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">kaiser</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">beta</span><span class="p">).</span><span class="o">&#39;</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">hd</span><span class="p">;</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>It turns out that the specification of <span class="math notranslate nohighlight">\(\delta_2 = 0.001\)</span> (-<span class="math notranslate nohighlight">\(60\)</span> dB)
is slightly violated in the stopband for this order. The achieved value is
<span class="math notranslate nohighlight">\(\delta_2 = 0.001053\)</span> (<span class="math notranslate nohighlight">\(-59.55\)</span> dB). This is often acceptable in
practice. The specification of <span class="math notranslate nohighlight">\(\delta_1 = 0.01\)</span> in the passband is well satisfied
due to the more stringent value of <span class="math notranslate nohighlight">\(\delta=0.001\)</span> is employed by
<code class="docutils literal notranslate"><span class="pre">kaiserord</span></code> to estimate the order <span class="math notranslate nohighlight">\(M\)</span>. One may also increment <span class="math notranslate nohighlight">\(M\)</span> to
<span class="math notranslate nohighlight">\(150\)</span> (a type-1 filter) to satisfy the specification of
<span class="math notranslate nohighlight">\(\delta_2 = 0.001\)</span>.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Increasing the order <span class="math notranslate nohighlight">\(M\)</span> while keeping the value of <span class="math notranslate nohighlight">\(\beta\)</span>
unchanged may not monotonically reduce the ripples in the passband
and stopband. For example, setting <span class="math notranslate nohighlight">\(M=150\)</span> meets the specification
of <span class="math notranslate nohighlight">\(\delta_2=0.001\)</span> in the stopband, but slightly increase the
maximum ripple value in the passband!</p>
</div>
<p>One may also use the MATLAB function <code class="docutils literal notranslate"><span class="pre">fir1</span></code> to generate the desired
impulse response by a least square optimization (instead of using
the ideal lowpass filter formula) and then apply the Kaiser window:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">h1f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">fir1</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">wc</span><span class="p">,</span><span class="w"> </span><span class="n">ftype</span><span class="p">,</span><span class="w"> </span><span class="n">kaiser</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">beta</span><span class="p">));</span><span class="w"> </span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">h1f</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
<p>The filter given by <code class="docutils literal notranslate"><span class="pre">fir1</span></code> is very similar to the
one obtained above using the ideal lowpass filter formula to
generate the desired impulse response <span class="math notranslate nohighlight">\(h_d[n]\)</span>. The
specification of <span class="math notranslate nohighlight">\(\delta_2 = 0.001\)</span> is again slightly violated in both
the stopband. Increasing <span class="math notranslate nohighlight">\(M\)</span> to<span class="math notranslate nohighlight">\(150\)</span> again meets the specification.</p>
</li>
<li><p><strong>MATLAB Example 2</strong>:</p>
<p>One may employ the frequency transformations described in
<a class="reference internal" href="linphase.html#sec-freqtrans"><span class="std std-numref">Section 6.5.4</span></a> to obtain other types of filters from the
lowpass filter obtained in Example 1 above. For instance, setting
<span class="math notranslate nohighlight">\(\hat h[n] = (-1)^n h[n]\)</span> will give us a highpass, generalized
linear-phase FIR filter with stopband <span class="math notranslate nohighlight">\([0, 0.65\pi]\)</span> and passband
<span class="math notranslate nohighlight">\([0.7\pi, \pi]\)</span>.</p>
<p>However, it is more convenient to use the MATLAB function <code class="docutils literal notranslate"><span class="pre">fir1</span></code>
again to design a highpass generalized linear-phase FIR filter:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">wc</span><span class="p">,</span><span class="w"> </span><span class="nb">beta</span><span class="p">,</span><span class="w"> </span><span class="n">ftype</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">kaiserord</span><span class="p">([</span><span class="mf">0.65</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.001</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">])</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">h2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">fir1</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">wc</span><span class="p">,</span><span class="w"> </span><span class="n">ftype</span><span class="p">,</span><span class="w"> </span><span class="n">kaiser</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">beta</span><span class="p">));</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p><strong>MATLAB Example 3</strong>:</p>
<p>To design a bandpass generalized linear-phase FIR filter with
passband <span class="math notranslate nohighlight">\([0.3\pi, 0.65\pi]\)</span> and stopband <span class="math notranslate nohighlight">\([0,0.25\pi] \cup [0.7\pi,
\pi]\)</span>, we can similarly use <code class="docutils literal notranslate"><span class="pre">fir1</span></code>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">wc</span><span class="p">,</span><span class="w"> </span><span class="nb">beta</span><span class="p">,</span><span class="w"> </span><span class="n">ftype</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">kaiserord</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.65</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.001</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001</span><span class="p">])</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">h3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">fir1</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">wc</span><span class="p">,</span><span class="w"> </span><span class="n">ftype</span><span class="p">,</span><span class="w"> </span><span class="n">kaiser</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">beta</span><span class="p">));</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">h3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="equiripple-design-parks-mcclellan-algorithm">
<h2><span class="section-number">6.6.3. </span>Equiripple Design - Parks-McClellan Algorithm<a class="headerlink" href="#equiripple-design-parks-mcclellan-algorithm" title="Permalink to this headline">#</a></h2>
<ul>
<li><p>The Parks-McClellan algorithm is a more systematic procedure to
generate a generalized linear-phase FIR filter of order <span class="math notranslate nohighlight">\(M\)</span> that
satisfies the specification <span class="math notranslate nohighlight">\((\hat\omega_p, \hat\omega_s, \delta_1,
\delta_2)\)</span>.</p></li>
<li><p>To explain the algorithm, first note that the real-valued component
<span class="math notranslate nohighlight">\(A(e^{j\hat\omega})\)</span> in the frequency response of any of the four
types of generalized linear-phase FIR filters described in
<a class="reference internal" href="linphase.html#sec-glinphasefir"><span class="std std-numref">Section 6.5.3</span></a> can be expressed in the following form:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  A(e^{j\hat\omega}) = Q(e^{j\hat\omega}) P(e^{j\hat\omega})
  \end{equation*}\]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  Q(e^{j\hat\omega}) 
  =
  \begin{cases}
  1 &amp; \text{ Type 1: } \text{even } M, \text{symmetric } h[n]\\
  \cos \frac{\hat\omega}{2} &amp; \text{ Type 2: } \text{odd } M,
  \text{symmetric } h[n] \\
  \sin \hat\omega &amp; \text{ Type 3: } \text{even } M, \text{antisymmetric }
  h[n] \\
  \sin \frac{\hat\omega}{2} &amp; \text{ Type 4: } \text{odd } M,
  \text{antisymmetric } h[n]
  \end{cases}
  \end{equation*}\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  P(e^{j\hat\omega}) = \sum_{k=0}^{N} \alpha_k \cos(\hat\omega k)
  \end{equation*}\]</div>
<p>with</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  N =
  \begin{cases}
  \frac{M}{2} &amp; \text{ Type 1} \\
  \frac{M-1}{2} &amp; \text{ Types 2 &amp; 4} \\
  \frac{M}{2} - 1 &amp; \text{ Type 3}
  \end{cases}
  \end{equation*}\]</div>
<p>and the coefficients <span class="math notranslate nohighlight">\(\{\alpha_k\}_{k=0}^{N}\)</span> are functions of
<span class="math notranslate nohighlight">\(h[n]\)</span> depending on the type of the generalized linear-phase FIR
filter (see <span id="id2">[<a class="reference internal" href="../refs.html#id6" title="John Proakis and Dimitris Manolakis. Digital Signal Processing: Principles, Algorithms, and Applications. Pearson, 5th edition, 2022.">PM22</a>]</span> <span class="math notranslate nohighlight">\(\S\)</span>10.2.4 for details).</p>
</li>
<li><p>For the case of designing a lowpass filter, the specification
<span class="math notranslate nohighlight">\((\hat\omega_p, \hat\omega_s, \delta_1, \delta_2)\)</span> translates to:</p>
<div class="math notranslate nohighlight" id="equation-e-aspec">
<span class="eqno">(6.11)<a class="headerlink" href="#equation-e-aspec" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{align}
1 - \delta_1 &amp;\leq A(e^{j\hat\omega}) \leq 1 + \delta_1
&amp; \text{for } |\hat\omega| \leq \hat\omega_p
\\
- \delta_2 &amp;\leq A(e^{j\hat\omega}) \leq \delta_2
&amp; \text{for } \hat\omega_s &lt; |\hat\omega| \leq \pi.
\end{align}\end{split}\]</div>
<p>The filter design problem can then be formulated as  choosing
<span class="math notranslate nohighlight">\(A(e^{j\hat\omega})\)</span> that satisfies the specification in
<a class="reference internal" href="#equation-e-aspec">(6.11)</a> to best approximate the desired
<span class="math notranslate nohighlight">\(\displaystyle A_d(e^{j\hat\omega}) 
= \begin{cases}
1 &amp; \text{for } |\hat\omega| \leq \hat\omega_p \\
0 &amp; \text{for } \hat\omega_s &lt; |\hat\omega| \leq \pi .
\end{cases}\)</span></p>
</li>
<li><p>Note that both <span class="math notranslate nohighlight">\(A_d(e^{j\hat\omega})\)</span> and <span class="math notranslate nohighlight">\(P(e^{j\hat\omega})\)</span> are
even functions of <span class="math notranslate nohighlight">\(\hat\omega\)</span>, and <span class="math notranslate nohighlight">\(Q(e^{j\hat\omega})\)</span> is either
even or odd in <span class="math notranslate nohighlight">\(\hat\omega\)</span>, it suffices to consider the design over
the frequency range <span class="math notranslate nohighlight">\(S = [0, \hat\omega_p] \cup [\hat\omega_s,
\pi]\)</span>, i.e., the positive-frequency passband and stopband.</p></li>
<li><p>Consider the weighted approximation error</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
  E(e^{j\hat\omega}) 
  &amp;= 
  W(e^{j\hat\omega})  \left[
  A_d(e^{j\hat\omega})  - A(e^{j\hat\omega})  \right]
  \\
  &amp;=
  \underbrace{W(e^{j\hat\omega}) Q(e^{j\hat\omega})}_{\tilde{W} (e^{j\hat\omega})} 
  \Bigg[ 
  \underbrace{\frac{A_d(e^{j\hat\omega})}{Q(e^{j\hat\omega})}}_{P_d(e^{j\hat\omega})}
  - P(e^{j\hat\omega}) 
  \Bigg] 
  \end{align*}\]</div>
<p>where the weighting function</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  W(e^{j\hat\omega}) = \begin{cases}
  \frac{\delta_2}{\delta_1} &amp; \text{if } 0 \leq \hat\omega \leq \hat\omega_p
  \\
  0 &amp; \text{if } \hat\omega_p &lt; \hat\omega &lt; \hat\omega_s
  \\
  1 &amp; \text{if } \hat\omega_s \leq \hat\omega \leq \pi
  \end{cases}
  \end{equation*}\]</div>
<p>is chosen to make sure that satisfying <span class="math notranslate nohighlight">\(|E(e^{j\hat\omega})| \leq \delta_2\)</span> in
<span class="math notranslate nohighlight">\(\hat\omega \in S\)</span> implies satisfying the design specification in
<a class="reference internal" href="#equation-e-aspec">(6.11)</a>.</p>
</li>
<li><p>We can now employ the following optimization formulation to address
the filter design problem:</p>
<div class="math notranslate nohighlight" id="equation-e-pmopt">
<span class="eqno">(6.12)<a class="headerlink" href="#equation-e-pmopt" title="Permalink to this equation">#</a></span>\[\begin{equation}
\min_{\{\alpha_k\}_{k=0}^N} \max_{\hat\omega \in S} |E(e^{j\hat\omega})|
=
\min_{\{\alpha_k\}_{k=0}^N} \max_{\hat\omega \in S} \left|
\tilde{W}(e^{j\hat\omega}) [ P_d(e^{j\hat\omega}) - P(e^{j\hat\omega})]
\right|.
\end{equation}\]</div>
<p>The design steps are then:</p>
<ol class="arabic simple">
<li><p>Pick a suitable generalized linear-phase FIR filter type (type 1
or 2 for lowpass design) and an initial value for the filter
order <span class="math notranslate nohighlight">\(M\)</span>.</p></li>
<li><p>Solve the optimization problem <a class="reference internal" href="#equation-e-pmopt">(6.12)</a>.</p></li>
<li><p>If the solution of <a class="reference internal" href="#equation-e-pmopt">(6.12)</a> (the minimum value) is smaller
than <span class="math notranslate nohighlight">\(\delta_2\)</span>, then terminate and output <span class="math notranslate nohighlight">\(\{\alpha_k\}_{k=0}^N\)</span>, and
hence the filter impulse response <span class="math notranslate nohighlight">\(h[n]\)</span>. Otherwise, increment
<span class="math notranslate nohighlight">\(M\)</span> and go back to step 2.</p></li>
</ol>
</li>
<li><p>There are also empirical formulas for estimating the order <span class="math notranslate nohighlight">\(M\)</span>
required to meet the specification <span class="math notranslate nohighlight">\((\hat\omega_p, \hat\omega_s,
\delta_1, \delta_2)\)</span>. The following formula is implemented in the
MATLAB function <code class="docutils literal notranslate"><span class="pre">firpmord</span></code> (see <span id="id3">[<a class="reference internal" href="../refs.html#id6" title="John Proakis and Dimitris Manolakis. Digital Signal Processing: Principles, Algorithms, and Applications. Pearson, 5th edition, 2022.">PM22</a>]</span> <span class="math notranslate nohighlight">\(\S\)</span>10.2.7 for
details):</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  M = 
  \frac{D_1 - D_2 (\Delta f)^2}{\Delta f}
  \end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\displaystyle \Delta f = \frac{\hat\omega_s -
\hat\omega_p}{2\pi}\)</span>, and</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
  D_1 
  &amp;= 
  \left[ 0.005309 (\log_{10} \delta_1)^2 + 0.07114 \log_{10}
  \delta_1 - 0.4761 \right] \cdot \log_{10} \delta_2 
  \\
  &amp; \hspace{15pt}- \left[ 0.00266
  (\log_{10} \delta_1)^2 + 0.5941 \log_{10} \delta_1 + 0.4278 \right]
  \\
  D_2 
  &amp;=
  11.012 + 0.51244 \left( \log_{10} \delta_1 - \log_{10} \delta_2
  \right).
  \end{align*}\]</div>
</li>
<li><p>Because <span class="math notranslate nohighlight">\(P(e^{j\hat\omega})\)</span> is  a polynomial of degree <span class="math notranslate nohighlight">\(N\)</span> in
<span class="math notranslate nohighlight">\(\cos\hat\omega\)</span>, we may employ the Chebyshev alternation theorem to
solve the optimization problem  <a class="reference internal" href="#equation-e-pmopt">(6.12)</a>:</p>
<div class="admonition-chebyshev-alternation admonition">
<p class="admonition-title">Chebyshev Alternation</p>
<p>A necessary and sufficient condition for <span class="math notranslate nohighlight">\(\{\alpha_k\}_{k=0}^N\)</span>
to be the unique solution of <a class="reference internal" href="#equation-e-pmopt">(6.12)</a> is that
<span class="math notranslate nohighlight">\(E(e^{j\hat\omega})\)</span> exhibits at
least <span class="math notranslate nohighlight">\(N+2\)</span> alternations in <span class="math notranslate nohighlight">\(S\)</span>, i.e., there are at least <span class="math notranslate nohighlight">\(N+2\)</span>
<strong>extremal frequencies</strong> <span class="math notranslate nohighlight">\(\hat\omega_0 &lt; \hat\omega_1 &lt; \cdots &lt;
\hat\omega_{N+1}\)</span> in <span class="math notranslate nohighlight">\(S\)</span> such that</p>
<div class="math notranslate nohighlight" id="equation-e-alternations">
<span class="eqno">(6.13)<a class="headerlink" href="#equation-e-alternations" title="Permalink to this equation">#</a></span>\[\begin{equation}
E(e^{j\hat\omega_i}) = -E(e^{j\hat\omega_{i+1}}) = \pm \delta
\end{equation}\]</div>
<p>for all <span class="math notranslate nohighlight">\(i\)</span>,  where <span class="math notranslate nohighlight">\(\delta = \max_{\hat\omega \in S} |E(e^{j\hat\omega})|\)</span>.
The property in <a class="reference internal" href="#equation-e-alternations">(6.13)</a> is usually referred to
as <strong>equiripple</strong>.</p>
</div>
</li>
<li><p>Using the Chebyshev alternation theorem, the solution to
<a class="reference internal" href="#equation-e-pmopt">(6.12)</a> must satisfy</p>
<div class="math notranslate nohighlight" id="equation-e-pmsolcond">
<span class="eqno">(6.14)<a class="headerlink" href="#equation-e-pmsolcond" title="Permalink to this equation">#</a></span>\[\begin{equation}
\tilde{W}(e^{j\hat\omega_i}) [ P_d(e^{j\hat\omega_i}) -
P(e^{j\hat\omega_i})]
= (-1)^i \delta
\end{equation}\]</div>
<p>for <span class="math notranslate nohighlight">\(i=0,1,\ldots, N+1\)</span>. Given <span class="math notranslate nohighlight">\(\{\hat\omega_i\}_{i=0}^{N+1}\)</span>,
<a class="reference internal" href="#equation-e-pmsolcond">(6.14)</a> is simply a system of <span class="math notranslate nohighlight">\(N+2\)</span> linear equations in
the <span class="math notranslate nohighlight">\(N+2\)</span> unknowns <span class="math notranslate nohighlight">\(\{\alpha_k\}_{k=0}^N\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span>. Solving this
system of linear equations gives, in particular,</p>
<div class="math notranslate nohighlight" id="equation-e-pmdelta">
<span class="eqno">(6.15)<a class="headerlink" href="#equation-e-pmdelta" title="Permalink to this equation">#</a></span>\[\begin{equation}
\delta = 
\frac{\sum_{i=0}^{N+1} \gamma_i  P_d(e^{j\hat\omega_i})}{\sum_{i=0}^{N+1} 
\frac{(-1)^i \gamma_i}{\tilde{W}(e^{j\hat\omega_i})}}
\end{equation}\]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  \gamma_i 
  = \prod_{n \neq i} \frac{1}{\cos\hat\omega_i - \cos\hat\omega_n}.
  \end{equation*}\]</div>
</li>
<li><p>Since we dont know <span class="math notranslate nohighlight">\(\{\hat\omega_i\}_{i=0}^{N+1}\)</span>, we may use the
<strong>Remez exchange algorithm</strong> to solve <a class="reference internal" href="#equation-e-pmopt">(6.12)</a> iteratively:</p>
<ol class="arabic simple">
<li><p>Make an initial guess of <span class="math notranslate nohighlight">\(\{\hat\omega_i\}_{i=0}^{N+1}\)</span> with
<span class="math notranslate nohighlight">\(\hat\omega_p=\hat\omega_j\)</span> and <span class="math notranslate nohighlight">\(\hat\omega_s= \hat\omega_{j+1}\)</span> for
some <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
<li><p>Given <span class="math notranslate nohighlight">\(\{\hat\omega_i\}_{i=0}^{N+1}\)</span>, solve <a class="reference internal" href="#equation-e-pmsolcond">(6.14)</a> for
<span class="math notranslate nohighlight">\(\delta\)</span> and <span class="math notranslate nohighlight">\(\{\alpha_k\}_{k=0}^N\)</span> to obtain
<span class="math notranslate nohighlight">\(P(e^{j\hat\omega_i})\)</span>. Alternatively, one may use
<a class="reference internal" href="#equation-e-pmdelta">(6.15)</a> to obtain <span class="math notranslate nohighlight">\(\delta\)</span> and the Lagrange polynomial of
order <span class="math notranslate nohighlight">\(N\)</span> to obtain <span class="math notranslate nohighlight">\(P(e^{j\hat\omega})\)</span> from the set of values
<span class="math notranslate nohighlight">\(\{P(e^{j\hat\omega_i})\}_{i=0}^{n+1}\)</span> given by <a class="reference internal" href="#equation-e-pmsolcond">(6.14)</a>
(see <span id="id4">[<a class="reference internal" href="../refs.html#id5" title="Alan Oppenheim and Ronald Schafer. Discrete-Time Signal Processing. Prentice Hall, 3rd edition, 2010.">OS10</a>]</span> Chapter 7 for details).</p></li>
<li><p>Calculate <span class="math notranslate nohighlight">\(E(e^{j\hat\omega})\)</span> on a dense grid of frequencies in
<span class="math notranslate nohighlight">\(S\)</span>. Find the local maxima and minima of <span class="math notranslate nohighlight">\(E(e^{j\hat\omega})\)</span>
satisfying <span class="math notranslate nohighlight">\(|E(e^{j\hat\omega})| \geq \delta\)</span>. Note that there
can be at most <span class="math notranslate nohighlight">\(N-1\)</span> such frequencies in the interior of <span class="math notranslate nohighlight">\(S\)</span>.</p></li>
<li><p>Add the passband and stopband edge frequencies, i.e., <span class="math notranslate nohighlight">\(0\)</span>,
<span class="math notranslate nohighlight">\(\hat\omega_s\)</span>, <span class="math notranslate nohighlight">\(\hat\omega_p\)</span>, and <span class="math notranslate nohighlight">\(\pi\)</span>, to the set of
frequencies of the local maxima and minima in step 3 above. This
set of frequencies give the <em>extrema</em> of <span class="math notranslate nohighlight">\(E(e^{j\hat\omega})\)</span>.</p></li>
<li><p>Retain the <span class="math notranslate nohighlight">\(N+2\)</span> frequencies in step 4 that give the largest
<span class="math notranslate nohighlight">\(N+2\)</span> extrema. Replace <span class="math notranslate nohighlight">\(\{\hat\omega_i\}_{i=0}^{N+1}\)</span> by this set
of <span class="math notranslate nohighlight">\(N+2\)</span> frequencies.</p></li>
<li><p>Go back to step 2 and repeat the procedure until
<span class="math notranslate nohighlight">\(\{\hat\omega_i\}_{i=0}^{N+1}\)</span> coverges.</p></li>
</ol>
</li>
<li><p><strong>MATLAB Example 4</strong>:</p>
<p>Consider the same design specification as in Example 1 above. That
is, we want to design a lowpass generalized linear-phase  FIR filter with the
specification <span class="math notranslate nohighlight">\((0.3\pi, 0.35\pi, 0.01, 0.001)\)</span>. We may use the
MATLAB function <code class="docutils literal notranslate"><span class="pre">firpmord</span></code> to first estimate the filter order <span class="math notranslate nohighlight">\(M\)</span>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">firpmord</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001</span><span class="p">])</span>

<span class="n">M</span><span class="w"> </span><span class="p">=</span>

<span class="w">   </span><span class="mi">102</span>

<span class="n">we</span><span class="w"> </span><span class="p">=</span>

<span class="w">         </span><span class="mi">0</span>
<span class="w">    </span><span class="mf">0.3000</span>
<span class="w">    </span><span class="mf">0.3500</span>
<span class="w">    </span><span class="mf">1.0000</span>

<span class="n">A</span><span class="w"> </span><span class="p">=</span>

<span class="w">     </span><span class="mi">1</span>
<span class="w">     </span><span class="mi">1</span>
<span class="w">     </span><span class="mi">0</span>
<span class="w">     </span><span class="mi">0</span>

<span class="n">W</span><span class="w"> </span><span class="p">=</span>

<span class="w">     </span><span class="mi">1</span>
<span class="w">    </span><span class="mi">10</span>
</pre></div>
</div>
<p>Then, we can use the MATLAB function <code class="docutils literal notranslate"><span class="pre">firpm</span></code> to implement the
Parks-McClellan algorithm to obtain a target impulse response:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">h4</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">firpm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">h4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>Since <span class="math notranslate nohighlight">\(M=102\)</span>, the filter given is a type-1 FIR filter.
The resulting specifications of <span class="math notranslate nohighlight">\(\delta_1=0.01\)</span> in the passband and
<span class="math notranslate nohighlight">\(\delta_2=0.001\)</span> in the stopband are both slightly
violated. Increasing the order <span class="math notranslate nohighlight">\(M\)</span> to <span class="math notranslate nohighlight">\(105\)</span> (a type-2 filter)
meets both specifications. Note that <strong>the order of the filter
obtained using the Parks-McClellan algorithm is significantly
smaller than that of the filter obtained by windowing design in
Example 1.</strong></p>
</li>
<li><p><strong>MATLAB Example 5</strong>:
Consider the same design problem of the highpass generalized
linear-phase FIR filter with passband <span class="math notranslate nohighlight">\([0.7\pi, \pi]\)</span> and stopband
<span class="math notranslate nohighlight">\([0,0.65\pi]\)</span> as in Example 2 above:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">firpmord</span><span class="p">([</span><span class="mf">0.65</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.001</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">])</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">h5</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">firpm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">h5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>The filter given is a type-1 FIR filter with order <span class="math notranslate nohighlight">\(M=106\)</span>. The
specifications of <span class="math notranslate nohighlight">\(\delta_1=0.001\)</span> and <span class="math notranslate nohighlight">\(\delta_2=0.01\)</span> are
satisfied.</p>
</li>
<li><p><strong>MATLAB Example 6</strong>:
Consider the same design problem of the bandpass generalized
linear-phase FIR filter with passband <span class="math notranslate nohighlight">\([0.3\pi, 0.65\pi]\)</span> and stopband
<span class="math notranslate nohighlight">\([0,0.25\pi] \cup [0.7\pi, \pi]\)</span> as in Example 3 above:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">firpmord</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.65</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.001</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001</span><span class="p">])</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">h6</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">firpm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">h6</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>The filter given is a type-1 FIR filter with  order <span class="math notranslate nohighlight">\(M=102\)</span>. The
specifications of <span class="math notranslate nohighlight">\(\delta_1=0.001\)</span> and <span class="math notranslate nohighlight">\(\delta_2=0.01\)</span> are not
satisfied with this value of <span class="math notranslate nohighlight">\(M\)</span>. Increasing <span class="math notranslate nohighlight">\(M\)</span> to <span class="math notranslate nohighlight">\(109\)</span> meets the
specifications.</p>
</li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ch6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="linphase.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6.5. </span>Linear-phase Filter</p>
      </div>
    </a>
    <a class="right-next"
       href="iirdesign.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.7. </span>IIR Filter Design</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-specifications">6.6.1. Filter Specifications</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#design-by-windowing">6.6.2. Design by Windowing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equiripple-design-parks-mcclellan-algorithm">6.6.3. Equiripple Design - Parks-McClellan Algorithm</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tan F. Wong
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>