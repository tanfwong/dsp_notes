

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6.7. IIR Filter Design &#8212; Foundations of DSP Notes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch6/iirdesign';</script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="../ch7/multirate.html" />
    <link rel="prev" title="6.6. FIR Filter Design" href="firdesign.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Foundations of Digital Signal Processing
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch1/review.html">1. Review of discrete-time signals and systems</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch1/signals.html">1.1. Discrete-time signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch1/systems.html">1.2. Discrete-time systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch1/ztransform.html">1.3. <span class="math notranslate nohighlight">\(z\)</span>-Transform</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch2/fourier.html">2. Fourier (Frequency Domain) Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch2/dtft.html">2.1. Discrete-Time Fourier Transform (DTFT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/dtft_tables.html">2.2. DTFT properties and tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/dirac_periodic.html">2.3. Periodic Dirac delta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/dtft_dirac_exs.html">2.4. DTFTs of infinite-energy signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/fs.html">2.5. Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/ft.html">2.6. Continuous-Time Fourier Transform (FT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch2/dirac.html">2.7. Dirac delta and FTs of infinite-energy signals</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch3/samp.html">3. Sampling and Reconstruction</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch3/poisson.html">3.1. Poisson Sum Formula</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch3/sampthm.html">3.2. Sampling Theorem</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch4/tdft.html">4. Time-dependent Fourier Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch4/uncertainty.html">4.1. Uncertainty Principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch4/stft.html">4.2. Short-time DTFT</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch5/comp.html">5. Computation of Fourier Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch5/fsamp.html">5.1. Frequency-domain Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch5/dft.html">5.2. Discrete Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch5/fft.html">5.3. Fast Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch5/fil_fft.html">5.4. Linear Filtering with FFT</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="fildesign.html">6. Filter Design</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="freqresp.html">6.1. Frequency Response of LTI System</a></li>
<li class="toctree-l2"><a class="reference internal" href="pz.html">6.2. Pole-Zero Placement</a></li>
<li class="toctree-l2"><a class="reference internal" href="allpass.html">6.3. Allpass Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="minphase.html">6.4. Minimum-phase Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="linphase.html">6.5. Linear-phase Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="firdesign.html">6.6. FIR Filter Design</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.7. IIR Filter Design</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ch7/mfilter.html">7. Multi-rate Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">8. References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tanfwong/dsp_notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tanfwong/dsp_notes/issues/new?title=Issue%20on%20page%20%2Fch6/iirdesign.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/ch6/iirdesign.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>IIR Filter Design</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prototype-analog-filters">6.7.1. Prototype Analog Filters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#butterworth-filter">6.7.1.1. Butterworth Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-i-chebyshev-filter">6.7.1.2. Type-I Chebyshev Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-ii-chebyshev-filter">6.7.1.3. Type-II Chebyshev Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#elliptic-filter">6.7.1.4. Elliptic Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analog-filter-design">6.7.1.5. Analog Filter Design</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#impulse-invariance-method">6.7.2. Impulse Invariance Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bilinear-transform-method">6.7.3. Bilinear Transform Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-transformation-of-iir-filters">6.7.4. Frequency Transformation of IIR filters</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="iir-filter-design">
<h1><span class="section-number">6.7. </span>IIR Filter Design<a class="headerlink" href="#iir-filter-design" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>Typically, we convert standard continuous-time (analog) filters to
obtain discrete-time IIR filters by applying appropriate
transformations.</p></li>
</ul>
<section id="prototype-analog-filters">
<span id="sec-afilter"></span><h2><span class="section-number">6.7.1. </span>Prototype Analog Filters<a class="headerlink" href="#prototype-analog-filters" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Let’s start by introducing a few common <strong>lowpass</strong> analog filter prototypes.</p></li>
</ul>
<section id="butterworth-filter">
<h3><span class="section-number">6.7.1.1. </span>Butterworth Filter<a class="headerlink" href="#butterworth-filter" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>A <strong>Butterworth filter</strong> of order <span class="math notranslate nohighlight">\(N\)</span> is an all-pole filter
characterized by the following square-magnitude response:</p>
<div class="math notranslate nohighlight" id="equation-e-butterworth">
<span class="eqno">(6.16)<a class="headerlink" href="#equation-e-butterworth" title="Permalink to this equation">#</a></span>\[\begin{equation} 
|H(\omega)|^2 
= 
\frac{1}{1 + \varepsilon^2 \left( \frac{\omega}{\omega_p} \right)^{2N}} 
=
\frac{1}{1 + \left( \frac{\omega}{\omega_c} \right)^{2N}}
\end{equation} \]</div>
<p>where <span class="math notranslate nohighlight">\(\omega_p\)</span> is the passband edge and
<span class="math notranslate nohighlight">\(\omega_c = \varepsilon^{-\frac{1}{N}} \omega_p\)</span> is the <span class="math notranslate nohighlight">\(3\)</span>dB cutoff
frequency.</p>
</li>
<li><p>The transfer function <span class="math notranslate nohighlight">\(H(s)\)</span> (the Laplace transform of the impulse
response <span class="math notranslate nohighlight">\(h(t)\)</span> of the Butterworth filter satisfies:</p>
<div class="math notranslate nohighlight" id="equation-e-butterworthtf">
<span class="eqno">(6.17)<a class="headerlink" href="#equation-e-butterworthtf" title="Permalink to this equation">#</a></span>\[\begin{equation}
H(s) H(-s) = 
\frac{1}{1 + \left( \frac{s}{j\omega_c} \right)^{2N}}.
\end{equation}\]</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Note that <span class="math notranslate nohighlight">\(|H(\omega)|^2 = H(s)H(-s) \big|_{s=j\omega}\)</span>.</p>
</div>
<p>The roots of the denominator polynomial on the RHS of
<a class="reference internal" href="#equation-e-butterworthtf">(6.17)</a> are <span class="math notranslate nohighlight">\(\tilde s_k = \omega_c e^{j\frac{2k+1+N}{2N}}\)</span> for
<span class="math notranslate nohighlight">\(k=0,1,\ldots, 2N-1\)</span>. That is, they are <span class="math notranslate nohighlight">\(2N\)</span> evenly spaced points on
the circle of radius <span class="math notranslate nohighlight">\(\omega_c\)</span> centered at the origin on the <span class="math notranslate nohighlight">\(s\)</span>-plane.
Selecting all the roots on the left-half plane, we obtain a stable filter with
transfer function:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  H(s) = 
  \frac{K}{\prod_{k=0}^{N-1} (s- \tilde s_k)}
  \end{equation*}\]</div>
<p>which gives our lowpass Butterworth filter prototype.</p>
</li>
<li><p>Note that <span class="math notranslate nohighlight">\(|H(\omega)|^2\)</span> in <a class="reference internal" href="#equation-e-butterworth">(6.16)</a> is monotone
decreasing in (positive) <span class="math notranslate nohighlight">\(\omega\)</span>. Thus there are no ripples in
either the passband or stopband for the Butterworth filter. We often
say that the Butterworth filter has <em>flat</em> passband and stopband.</p></li>
</ul>
</section>
<section id="type-i-chebyshev-filter">
<h3><span class="section-number">6.7.1.2. </span>Type-I Chebyshev Filter<a class="headerlink" href="#type-i-chebyshev-filter" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>A <strong>type-I Chebyshev filter</strong> of order <span class="math notranslate nohighlight">\(N\)</span> is an all-pole filter
characterized by:</p>
<div class="math notranslate nohighlight" id="equation-e-chebyshevi">
<span class="eqno">(6.18)<a class="headerlink" href="#equation-e-chebyshevi" title="Permalink to this equation">#</a></span>\[\begin{equation} 
|H(\omega)|^2 
= 
\frac{1}{1 + \varepsilon^2 T^2_N\left( \frac{\omega}{\omega_p} \right)} 
\end{equation} \]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  T_N(x) = \begin{cases}
  \cos \left( N \cos^{-1}(x) \right) &amp; \text{if } |x| \leq 1
  \\
  \cosh \left( N \cosh^{-1}(x) \right) &amp; \text{if } |x| &gt; 1
  \end{cases}
  \end{equation*}\]</div>
<p>is the Chebyshev polynomial of degree <span class="math notranslate nohighlight">\(N\)</span>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One may also get the Chebyshev polynomials using the following recursion:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
T_0(x) &amp;= 1 \\
T_1(x) &amp;= x \\
T_{n+1}(x) &amp;= 2xT_n(x) - T_{n-1}(x)
&amp; \text{for } n \geq 1.
\end{align*}\]</div>
</div>
</li>
<li><p>The poles of <span class="math notranslate nohighlight">\(H(s)H(-s)\)</span> of the type-I Chebyshev filter lie on an
ellipse centered at the origin on the <span class="math notranslate nohighlight">\(s\)</span>-plane with major and minor
axis radii <span class="math notranslate nohighlight">\(\displaystyle r_1 = \frac{\omega_p (\beta^2
+1)}{2\beta}\)</span> and <span class="math notranslate nohighlight">\(\displaystyle r_2 = \frac{\omega_p (\beta^2
-1)}{2\beta}\)</span>, where <span class="math notranslate nohighlight">\(\displaystyle \beta = \left(
\frac{\sqrt{1+\varepsilon^2} +1}{\varepsilon}
\right)^{\frac{1}{N}}\)</span>.  Choosing all poles on the left half plane
gives a stable</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  H(s) = 
  \frac{K}{\prod_{k=0}^{N-1} (s-s_k)}
  \end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(s_k = r_2 \cos \phi_k  + j r_1 \sin \phi_k\)</span> and <span class="math notranslate nohighlight">\(\phi_k =
\frac{2k+1+N}{2N}\)</span> for <span class="math notranslate nohighlight">\(k=0,1,\ldots, N-1\)</span>.</p>
</li>
<li><p>The type-I Chebyshev filter is equiripple in the passband and flat in the stopband.</p></li>
</ul>
</section>
<section id="type-ii-chebyshev-filter">
<h3><span class="section-number">6.7.1.3. </span>Type-II Chebyshev Filter<a class="headerlink" href="#type-ii-chebyshev-filter" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>A <strong>type-II Chebyshev filter</strong> of order <span class="math notranslate nohighlight">\(N\)</span> is a filter with <span class="math notranslate nohighlight">\(N\)</span>
zeros and <span class="math notranslate nohighlight">\(N\)</span> poles characterized by:</p>
<div class="math notranslate nohighlight" id="equation-e-chebyshevii">
<span class="eqno">(6.19)<a class="headerlink" href="#equation-e-chebyshevii" title="Permalink to this equation">#</a></span>\[\begin{equation} 
|H(\omega)|^2 
= 
\frac{1}{1 + \varepsilon^2 \frac{T^2_N\left(\frac{\omega_s}{\omega_p}\right)}{
T^2_N\left( \frac{\omega_s}{\omega} \right)} }
\end{equation} \]</div>
<p>where <span class="math notranslate nohighlight">\(\omega_p\)</span> and <span class="math notranslate nohighlight">\(\omega_s\)</span> are the passband and stopband edge
frequency, respectively.</p>
</li>
<li><p>For a stable filter, the transfer function of the type-II Chebyshev
filter is given by</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  H(s) = 
  \frac{K \prod_{k=0}^{N-1} (s-z_k)}{\prod_{k=0}^{N-1} (s-p_k)}
  \end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(z_k = \frac{j\omega_s}{\sin \phi_k}\)</span> and <span class="math notranslate nohighlight">\(p_k =
\frac{\omega_s s_k}{\sqrt{r_2^2 \cos^2 \phi_k  + r_1^2 \sin^2
\phi_k}}\)</span> for <span class="math notranslate nohighlight">\(k=0,1,\ldots, N-1\)</span>.</p>
</li>
<li><p>The type-II Chebyshev filter is equiripple in the stopband and flat
in the passband.</p></li>
</ul>
</section>
<section id="elliptic-filter">
<h3><span class="section-number">6.7.1.4. </span>Elliptic Filter<a class="headerlink" href="#elliptic-filter" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>An <strong>elliptic filter</strong> of order <span class="math notranslate nohighlight">\(N\)</span> is a filter with <span class="math notranslate nohighlight">\(N\)</span>
zeros and <span class="math notranslate nohighlight">\(N\)</span> poles characterized by:</p>
<div class="math notranslate nohighlight" id="equation-e-elliptic">
<span class="eqno">(6.20)<a class="headerlink" href="#equation-e-elliptic" title="Permalink to this equation">#</a></span>\[\begin{equation} 
|H(\omega)|^2 
= 
\frac{1}{1 + \varepsilon^2 U^2_N\left(\frac{\omega}{\omega_p}\right)}
\end{equation} \]</div>
<p>where <span class="math notranslate nohighlight">\(U_N(\cdot)\)</span> is the Jacobian elliptic function of order <span class="math notranslate nohighlight">\(N\)</span>
(see <span id="id1">[<a class="reference internal" href="../refs.html#id7" title="Sophocles J. Orfanidis. Lecture notes on elliptic filter design. Technical Report, Rutgers University, Nov. 2006. URL: https://www.ece.rutgers.edu/~orfanidi/ece521/notes.pdf.">Orf06</a>]</span> for details).</p>
</li>
<li><p>The zeros of the transfer function <span class="math notranslate nohighlight">\(H(s)\)</span> of the elliptic filter are
on the <span class="math notranslate nohighlight">\(j\omega\)</span>-axis.</p></li>
<li><p>The elliptic filter is equiripple in both the passband and stopband.</p></li>
<li><p>The elliptic filter has a lower order than the Butterworth and
Chebyshev filters for the same specification.</p></li>
</ul>
</section>
<section id="analog-filter-design">
<span id="sec-atrans"></span><h3><span class="section-number">6.7.1.5. </span>Analog Filter Design<a class="headerlink" href="#analog-filter-design" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>To design an analog lowpass filter with specification <span class="math notranslate nohighlight">\((\omega_p,
\omega_s, \delta_1, \delta_2)\)</span>:</p>
<ol class="arabic simple">
<li><p>Pick a filter type from above (Butterworth, type-I Chebyshev,
type-II Chebyshev, or elliptic).</p></li>
<li><p>Use <a class="reference internal" href="#equation-e-butterworth">(6.16)</a>, <a class="reference internal" href="#equation-e-chebyshevi">(6.18)</a>, <a class="reference internal" href="#equation-e-chebyshevii">(6.19)</a>,
or <a class="reference internal" href="#equation-e-elliptic">(6.20)</a> to determine the value <span class="math notranslate nohighlight">\(\varepsilon\)</span> from
<span class="math notranslate nohighlight">\(\delta_1\)</span>.</p></li>
<li><p>Find the minimum filter order <span class="math notranslate nohighlight">\(N\)</span> such that the specifications of
<span class="math notranslate nohighlight">\(\delta_1\)</span> and <span class="math notranslate nohighlight">\(\delta_2\)</span> are satisfied in the passband and
stopband, respectively.</p></li>
</ol>
</li>
<li><p>After obtaining the transfer function <span class="math notranslate nohighlight">\(H(s)\)</span> of a lowpass prototype
design with passband edge frequency <span class="math notranslate nohighlight">\(\omega_p\)</span>, one may use the
transformations given in the table below to get the transfer
function <span class="math notranslate nohighlight">\(H'(s)\)</span> of another type of filter:</p>
<table class="table">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>New filter type</p></th>
<th class="head"><p>New band edge(s)</p></th>
<th class="head"><p>Transformation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Lowpass</p></td>
<td><p><span class="math notranslate nohighlight">\(\omega'_p\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(H'(s) = H \left(\frac{\omega_p}{\omega'_p} s\right)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Highpass</p></td>
<td><p><span class="math notranslate nohighlight">\(\omega'_p\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle H'(s) = H \left(\frac{\omega_p\omega'_p}{s} \right)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Bandpass</p></td>
<td><p><span class="math notranslate nohighlight">\(\omega_l, \omega_u\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle H'(s) = H \left(\omega_p \frac{s^2+\omega_u
\omega_l}{s(\omega_u-\omega_l)} \right)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Bandstop</p></td>
<td><p><span class="math notranslate nohighlight">\(\omega_l, \omega_u\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle H'(s) = H \left(\omega_p \frac{s(\omega_u-
\omega_l)}{s^2+\omega_u \omega_l} \right)\)</span></p></td>
</tr>
</tbody>
</table>
</li>
</ul>
</section>
</section>
<section id="impulse-invariance-method">
<h2><span class="section-number">6.7.2. </span>Impulse Invariance Method<a class="headerlink" href="#impulse-invariance-method" title="Permalink to this headline">#</a></h2>
<ul>
<li><p>Sample the impulse response <span class="math notranslate nohighlight">\(h(t)\)</span> of an analog lowpass
filter prototype at sampling rate <span class="math notranslate nohighlight">\(f_s\)</span> to obtain the impulse
response <span class="math notranslate nohighlight">\(\displaystyle h[n] = \frac{1}{f_s} h\left(\frac{n}{f_s}
 \right)\)</span> of the target discrete-time lowpass IIR filter.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(h(t)\)</span> is bandlimited and we oversample <span class="math notranslate nohighlight">\(h(t)\)</span> to get <span class="math notranslate nohighlight">\(h[n]\)</span>,
then from that the Poisson sum formula <a class="reference internal" href="../ch3/sampthm.html#equation-e-folded-spectrum">(3.6)</a>,
the frequency response of <span class="math notranslate nohighlight">\(h[n]\)</span> is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
  H(e^{j\hat\omega}) 
  &amp;= H(\hat\omega f_s)
  &amp; \text{  for  }  -\pi \leq \hat\omega &lt; \pi
  \end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(H(\omega)\)</span> is the frequency response of <span class="math notranslate nohighlight">\(h(t)\)</span>.
Thus, the design specification <span class="math notranslate nohighlight">\((\hat\omega_p, \hat\omega_s,
\delta_1, \delta_2)\)</span> of the discrete-time lowpass IIR filter will be
met if we set <span class="math notranslate nohighlight">\(\omega_p = \hat\omega_p f_s\)</span>, <span class="math notranslate nohighlight">\(\omega_s =
\hat\omega_s f_s\)</span>, and design the continuous-time lowpass filter
prototype to satisfy the specification <span class="math notranslate nohighlight">\((\omega_p, \omega_s,
\delta_1, \delta_2)\)</span>.</p>
</li>
<li><p>Often, we use the Butterworth, Chebyshev, and elliptic filters
described above as prototypes for the analog filter design.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Since the magnitude responses of the Butterworth, Chebyshev, and
elliptic (see  <a class="reference internal" href="#equation-e-butterworth">(6.16)</a>, <a class="reference internal" href="#equation-e-chebyshevi">(6.18)</a>, <a class="reference internal" href="#equation-e-chebyshevii">(6.19)</a>,
and <a class="reference internal" href="#equation-e-elliptic">(6.20)</a>) are functions of the ratio
<span class="math notranslate nohighlight">\(\frac{\omega}{\omega_p}\)</span> or <span class="math notranslate nohighlight">\(\frac{\omega_s}{\omega}\)</span>, we may
simply set <span class="math notranslate nohighlight">\(f_s = 1\)</span> in the design process without any loss of generality.</p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>As none of the Butterworth, Chebyshev, and
elliptic filters are strictly bandlimited, the impulse invariance
design obtained by sampling the impulse response of the analog
filter prototype may suffer from aliasing, typically causing larger
stopband ripples. To overcome this problem, we may need to use a
tighter values for <span class="math notranslate nohighlight">\(\delta_1\)</span> and <span class="math notranslate nohighlight">\(\delta_2\)</span> so that the achieved
ripples in the passband and stopband are within the original specification.</p>
</div>
</li>
<li><p>Note that the analog filter prototypes described in
<a class="reference internal" href="#sec-afilter"><span class="std std-numref">Section 6.7.1</span></a> above all have single-order poles. Hence their
continuous-time transfer functions have the following partial
fraction expansion:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  H(s) = A_0 + \sum_{k=0}^{N-1} \frac{A_k}{s - p_k}
  \end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(p_0, p_1, \ldots, p_{N-1}\)</span> are the poles. Taking inverse
Laplace transform to get the causal impulse response</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  h(t) = A_0 \delta(t)+ \sum_{k=0}^{N-1} A_k e^{p_k t} u(t).
  \end{equation*}\]</div>
<p>Sampling <span class="math notranslate nohighlight">\(h(t)\)</span> at <span class="math notranslate nohighlight">\(f_s=1\)</span> gives</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  h[n] = A_0 \delta[n]+ \sum_{k=0}^{N-1} A_k e^{p_k n} u[n].
  \end{equation*}\]</div>
<p>Taking <span class="math notranslate nohighlight">\(z\)</span>-transform on <span class="math notranslate nohighlight">\(h[n]\)</span>, we get</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  H(z) = A_0 + \sum_{k=0}^{N-1} \frac{A_k}{1 - e^{p_k} z^{-1}}
  \end{equation*}\]</div>
<p>Since <span class="math notranslate nohighlight">\(H(s)\)</span> is table by construction, <span class="math notranslate nohighlight">\(\text{Re}(p_k) &lt; 0\)</span> for
<span class="math notranslate nohighlight">\(k=0,1,\ldots, N-1\)</span>. Thus the poles <span class="math notranslate nohighlight">\(e^{p_k}\)</span> of the transfer
function <span class="math notranslate nohighlight">\(H(z)\)</span> of the resulting discrete-time IIR filter are all
strictly inside the unit circle, i.e., <span class="math notranslate nohighlight">\(H(z)\)</span> is also stable.</p>
</li>
<li><p><strong>MATLAB Example 7</strong>:</p>
<p>Consider again the same design specification as in Examples 1 and 4
in <a class="reference internal" href="firdesign.html#sec-firdesign"><span class="std std-numref">Section 6.6</span></a>, except in this example we want to design
a lowpass IIR filter with the specification <span class="math notranslate nohighlight">\((0.3\pi, 0.35\pi, 0.01,
0.001)\)</span> based on a analog type-I Chebyshev filter prototype. Using the
impulse invariance method with <span class="math notranslate nohighlight">\(f_s=1\)</span>, the required specifications
of the analog type-I Chebyshev filter prototype are <span class="math notranslate nohighlight">\(\omega_p=0.3\pi\)</span>,
<span class="math notranslate nohighlight">\(\omega_s=0.35\pi\)</span>, <span class="math notranslate nohighlight">\(\delta_1=0.01\)</span>, and <span class="math notranslate nohighlight">\(\delta_2=0.001\)</span>.</p>
<p>Next, we employ <a class="reference internal" href="#equation-e-chebyshevi">(6.18)</a> to determine the value
of <span class="math notranslate nohighlight">\(\varepsilon\)</span> and the filter order <span class="math notranslate nohighlight">\(N\)</span> required to meet the
specifications. We can be done using the MATLAB function <code class="docutils literal notranslate"><span class="pre">cheb1ord</span></code>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.01</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mf">0.001</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1ord</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s&#39;</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mi">17</span>


<span class="n">wp</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mf">0.9425</span>
</pre></div>
</div>
<p>to get that the filter required order is <span class="math notranslate nohighlight">\(N=17\)</span>. Note that the value
of <span class="math notranslate nohighlight">\(\varepsilon\)</span> depends only on <span class="math notranslate nohighlight">\(\delta_1\)</span> and <span class="math notranslate nohighlight">\(\omega_p\)</span>.
Then we can use the MATLAB function <code class="docutils literal notranslate"><span class="pre">cheby1</span></code> to obtain the analog
type-I Chebyshev filter prototype:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">]=</span><span class="w"> </span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s&#39;</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">freqs</span><span class="p">(</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mf">0.0001</span><span class="p">:</span><span class="nb">pi</span><span class="p">]);</span>
</pre></div>
</div>
<p>We can see that the analog filter prototype meets its specifications.
Finally, we may use the MATLAB function <code class="docutils literal notranslate"><span class="pre">impinvar</span></code> to apply the
impulse invariance method to obtain the target discrete-time IIR filter:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">impinvar</span><span class="p">(</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<p>We can check that the original specification <span class="math notranslate nohighlight">\((0.3\pi, 0.35\pi, 0.01,
0.001)\)</span>  is met.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Note that the order of the IIR filter obtained from the impulse
invariance method is much smaller than those of
the FIR filters obtained in Examples 1 and 4 with the same
specification. However, the group
delay of the IIR filter is not a constant over the passband.</p>
</div>
</li>
<li><p><strong>MATLAB Example 8</strong>:</p>
<p>Repeat Example 7 using an analog elliptic filter prototype instead:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.01</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mf">0.001</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellipord</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s&#39;</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mi">9</span>


<span class="n">wp</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mf">0.9425</span>

<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s&#39;</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">freqs</span><span class="p">(</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mf">0.0001</span><span class="p">:</span><span class="nb">pi</span><span class="p">]);</span>
</pre></div>
</div>
<p>We can see that this analog filter prototype also meets its specifications.
However, applying the impulse invariance method:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">impinvar</span><span class="p">(</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<p>We see that the resulting IIR filter violates its specifications
in both the passband and stopband. Redoing the design with more
stringent values for <span class="math notranslate nohighlight">\(\delta_1\)</span> and <span class="math notranslate nohighlight">\(\delta_2\)</span>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.01</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mf">0.001</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellipord</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="o">*</span><span class="mf">0.75</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="o">+</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s&#39;</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mi">10</span>


<span class="n">wp</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mf">0.9425</span>


<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="o">*</span><span class="mf">0.75</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="o">+</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s&#39;</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">impinvar</span><span class="p">(</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<p>gives an IIR filter that satisfies the specification of <span class="math notranslate nohighlight">\((0.3\pi, 0.35\pi, 0.01,
0.001)\)</span>. Note that the order of this IIR filter is <span class="math notranslate nohighlight">\(N=10\)</span>, smaller
than that of the IIR filter obtained from the type-I Chebyshev prototype.</p>
</li>
</ul>
</section>
<section id="bilinear-transform-method">
<h2><span class="section-number">6.7.3. </span>Bilinear Transform Method<a class="headerlink" href="#bilinear-transform-method" title="Permalink to this headline">#</a></h2>
<ul>
<li><p>Obtain the transfer function <span class="math notranslate nohighlight">\(H(z)\)</span> of the discrete-time IIR filter
directly from the transfer function <span class="math notranslate nohighlight">\(H(s)\)</span> of an anlog prototype
filter by the bilinear transformation:</p>
<div class="math notranslate nohighlight" id="equation-e-bilinear">
<span class="eqno">(6.21)<a class="headerlink" href="#equation-e-bilinear" title="Permalink to this equation">#</a></span>\[\begin{equation}
s = 2f_s \left( \frac{ 1- z^{-1}}{1+z^{-1}} \right)
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(f_s\)</span> is the sampling rate.</p>
</li>
<li><p>Let <span class="math notranslate nohighlight">\(s=\sigma + j \omega\)</span>. Inverting the bilinear transform gives</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
  z
  &amp;=
  \frac{1 + \frac{s}{2f_s}}{1 - \frac{s}{2f_s}}
  \\
  &amp;=
  \frac{1 + \frac{\sigma}{2f_s} + j\frac{\omega}{2f_s}}{1 -
  \frac{\sigma}{2f_s} - j\frac{\omega}{2f_s}}.
  \end{align*}\]</div>
<p>Thus:</p>
<ol class="arabic simple">
<li><p>If <span class="math notranslate nohighlight">\(\sigma&lt;0\)</span>, then <span class="math notranslate nohighlight">\(|z| &lt; 1\)</span>. That is, the left half <span class="math notranslate nohighlight">\(s\)</span>-plane is
mapped onto the inside of the unit circle in the <span class="math notranslate nohighlight">\(z\)</span>-plane by the
bilinear transform.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\sigma&gt;0\)</span>, then <span class="math notranslate nohighlight">\(|z| &gt; 1\)</span>. That is, the right half <span class="math notranslate nohighlight">\(s\)</span>-plane is
mapped onto the outside of the unit circle in the <span class="math notranslate nohighlight">\(z\)</span>-plane by the
bilinear transform.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\sigma=0\)</span>, then <span class="math notranslate nohighlight">\(|z| = 1\)</span>. That is, the <span class="math notranslate nohighlight">\(j\omega\)</span> axis of
<span class="math notranslate nohighlight">\(s\)</span>-plane is mapped onto the unit circle of the <span class="math notranslate nohighlight">\(z\)</span>-plane by the
bilinear transform.</p></li>
</ol>
</li>
<li><p>From observation 1, the bilinear transform <a class="reference internal" href="#equation-e-bilinear">(6.21)</a> maps
causal stable analog filter to a causal stable discrete-time IIR filter.</p></li>
<li><p>Based on observation 3, substituting <span class="math notranslate nohighlight">\(s=j\omega\)</span> and
<span class="math notranslate nohighlight">\(z=e^{j\hat\omega}\)</span> into <a class="reference internal" href="#equation-e-bilinear">(6.21)</a> gives</p>
<div class="math notranslate nohighlight" id="equation-e-bilinfreq">
<span class="eqno">(6.22)<a class="headerlink" href="#equation-e-bilinfreq" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{align} 
\omega 
&amp;= \frac{2 f_s}{j} \left( \frac{1 -
e^{-j\hat\omega}}{1 + e^{-j\hat\omega}} \right) 
\\ 
&amp;= 2 f_s \tan \frac{\hat\omega}{2} 
\end{align} \end{split}\]</div>
<p>for <span class="math notranslate nohighlight">\(-\pi \leq \hat\omega &lt; \pi\)</span>, which shows that
the mapping between the <span class="math notranslate nohighlight">\(j\omega\)</span> axis
of <span class="math notranslate nohighlight">\(s\)</span>-plane and the unit circle of the <span class="math notranslate nohighlight">\(z\)</span>-plane, i.e., between the
angular frequency <span class="math notranslate nohighlight">\(\omega\)</span> of the analog filter and the normalized
radian frequency <span class="math notranslate nohighlight">\(\hat\omega\)</span> of the discrete-time filter, induced
by the bilinear transform <a class="reference internal" href="#equation-e-bilinear">(6.21)</a> is one-to-one. As a
result, <strong>the bilinear transform  <a class="reference internal" href="#equation-e-bilinear">(6.21)</a> can be employed to
turn lowpass, highpass, bandpass, and bandstop analog filter
prototypes to their respective discrete-time counterparts</strong>.</p>
</li>
<li><p>The design steps of the bilinear tranform method are then simply:</p>
<ol class="arabic simple">
<li><p>Starting from the specification of the discrete-time IIR filter,
use <a class="reference internal" href="#equation-e-bilinfreq">(6.22)</a> to convert the specification to one for the
analog filter prototype. For example, the specification
<span class="math notranslate nohighlight">\((\hat\omega_p, \hat\omega_s, \delta_1, \delta_2)\)</span> for the case
of a lowpass discrete-time filter is converted to the
specification <span class="math notranslate nohighlight">\((\omega_p, \omega_s, \delta_1, \delta_2)\)</span> of a
lowpass analog filter prototype, where <span class="math notranslate nohighlight">\(\omega_p\)</span> and <span class="math notranslate nohighlight">\(\omega_s\)</span>
are obtained from <span class="math notranslate nohighlight">\(\hat\omega_p\)</span> and <span class="math notranslate nohighlight">\(\hat\omega_s\)</span> using
<a class="reference internal" href="#equation-e-bilinfreq">(6.22)</a>, respectively.</p></li>
<li><p>Design an analog filter prototype that satisfies the
specification obtained in step 1.</p></li>
<li><p>Use the bilinear transform  <a class="reference internal" href="#equation-e-bilinear">(6.21)</a> to obtain the
transfer function <span class="math notranslate nohighlight">\(H(z)\)</span> of the target discrete-time IIR filter
from the transfer function <span class="math notranslate nohighlight">\(H(s)\)</span> of the analog filter prototype
in step 2.</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As in the impulse invariance method,
since the magnitude responses of the Butterworth, Chebyshev, and
elliptic (see  <a class="reference internal" href="#equation-e-butterworth">(6.16)</a>, <a class="reference internal" href="#equation-e-chebyshevi">(6.18)</a>, <a class="reference internal" href="#equation-e-chebyshevii">(6.19)</a>,
and <a class="reference internal" href="#equation-e-elliptic">(6.20)</a>) are functions of the ratio
<span class="math notranslate nohighlight">\(\frac{\omega}{\omega_p}\)</span> or <span class="math notranslate nohighlight">\(\frac{\omega_s}{\omega}\)</span>, we may
set <span class="math notranslate nohighlight">\(f_s = 1\)</span> in the design process above without any loss of generality.</p>
</div>
</li>
<li><p><strong>MATLAB Example 9</strong>:</p>
<p>Repeat Example 7 above, except using the bilinear transform method
with <span class="math notranslate nohighlight">\(f_s=1\)</span> to obtain the discrete-time IIR filter from an analog
type-I Chebyshev filter prototype. First, use <a class="reference internal" href="#equation-e-bilinfreq">(6.22)</a> to
obtain <span class="math notranslate nohighlight">\(\omega_p\)</span> and <span class="math notranslate nohighlight">\(\omega_s\)</span> from the IIR filter’s specification
in order to design the analog prototype:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.01</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mf">0.001</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">tan</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">ws</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">tan</span><span class="p">(</span><span class="mf">0.35</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span><span class="w"> </span><span class="n">ws</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s&#39;</span><span class="p">)</span>
<span class="n">N</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mi">16</span>

<span class="n">wp</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mf">1.0191</span>

<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s&#39;</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">freqs</span><span class="p">(</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mf">0.0001</span><span class="p">:</span><span class="nb">pi</span><span class="p">]);</span>
</pre></div>
</div>
<p>Then, we can use the MATLAB function <code class="docutils literal notranslate"><span class="pre">bilinear</span></code> to apply the
bilinear transformation in <a class="reference internal" href="#equation-e-bilinear">(6.21)</a> to get the discrete-time
IIR filter:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bilinear</span><span class="p">(</span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One may more conveniently use the MATLAB function <code class="docutils literal notranslate"><span class="pre">cheby1</span></code> to
directly perform the steps above:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1ord</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mi">16</span>

<span class="n">wp</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mf">0.3000</span>

<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
</div>
</li>
<li><p><strong>MATLAB Example 10</strong>:</p>
<p>Design a discrete-time highpass IIR filter with passband <span class="math notranslate nohighlight">\([0.7\pi,
\pi]\)</span> and ripple tolerance <span class="math notranslate nohighlight">\(\delta_1 = 0.01\)</span>, and stopband
<span class="math notranslate nohighlight">\([0,0.65\pi]\)</span> and ripple tolerance <span class="math notranslate nohighlight">\(\delta_2=0.001\)</span> as in Example 5
in <a class="reference internal" href="firdesign.html#sec-firdesign"><span class="std std-numref">Section 6.6</span></a>. Following Example 9, we use the type-I
Chebyshev filter as our prototype analog filter to perform the design.</p>
<p>The following MATLAB commands:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.01</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mf">0.001</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1ord</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="w"> </span><span class="mf">0.65</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mi">16</span>

<span class="n">wp</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mf">0.7000</span>

<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;high&#39;</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<p>design an analog lowpass type-I Chebyshev filter with <span class="math notranslate nohighlight">\(\omega_p =
 1\)</span> radian per second satisfying the <span class="math notranslate nohighlight">\(\delta_1\)</span> and <span class="math notranslate nohighlight">\(\delta_2\)</span>
specifications, transform the lowpass prototype to a highpass
prototype using the table in <a class="reference internal" href="#sec-atrans"><span class="std std-numref">Section 6.7.1.5</span></a>, and finally
apply the bilinear transformation to obtain the desired
discrete-time highpass IIR filter.</p>
</li>
<li><p><strong>MATLAB Example 11</strong>:</p>
<p>Design a discrete-time bandpass IIR filter with passband <span class="math notranslate nohighlight">\([0.5\pi,
0.7\pi]\)</span> and ripple tolerance <span class="math notranslate nohighlight">\(\delta_1 = 0.01\)</span>, and stopband
<span class="math notranslate nohighlight">\([0,0.45\pi] \cup [0.75\pi, \pi]\)</span> and ripple tolerance <span class="math notranslate nohighlight">\(\delta_2=0.001\)</span>.
Again, we use the type-I Chebyshev filter as our prototype analog filter to
perform the design as in the following MATLAB commands:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.01</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mf">0.001</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1ord</span><span class="p">([</span><span class="mf">0.5</span><span class="w"> </span><span class="mf">0.7</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.45</span><span class="w"> </span><span class="mf">0.75</span><span class="p">],</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mi">10</span>

<span class="n">wp</span><span class="w"> </span><span class="p">=</span>

<span class="w">    </span><span class="mf">0.5000</span><span class="w">    </span><span class="mf">0.7000</span>

<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<p>to obtain the desired discrete-time bandpass IIR filter. Note that
the order of the filter obtained is <span class="math notranslate nohighlight">\(N=20\)</span>.</p>
</li>
</ul>
</section>
<section id="frequency-transformation-of-iir-filters">
<h2><span class="section-number">6.7.4. </span>Frequency Transformation of IIR filters<a class="headerlink" href="#frequency-transformation-of-iir-filters" title="Permalink to this headline">#</a></h2>
<ul>
<li><p>In <a class="reference internal" href="linphase.html#sec-freqtrans"><span class="std std-numref">Section 6.5.4</span></a>, we discuss how to transform a lowpass
FIR filter to a highpass one by frequency shifting. The same
frequency-shifting transformation clearly applies to IIR filters
also. As a matter of fact, a more general class of transformations
that map the unit circle (on the <span class="math notranslate nohighlight">\(z\)</span>-plane) onto itself can be
applied to convert a lowpass IIR filter to another IIR filter fo
other types.</p></li>
<li><p>Write the mapping discussed above as <span class="math notranslate nohighlight">\(z^{-1} \mapsto
G(z^{-1})\)</span>. Since the unti circle is mapped onto itself,
<span class="math notranslate nohighlight">\(|G(z^{-1})| = 1\)</span>. That means, we can think of <span class="math notranslate nohighlight">\(G(z^{-1})\)</span> as the
transfer function of an allpass filter of the general form
<a class="reference internal" href="allpass.html#equation-e-allpass-gen">(6.5)</a> with <span class="math notranslate nohighlight">\(b_0=\pm 1\)</span>, i.e.,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  G(z^{-1}) = \pm \prod_{k=1}^N \frac{-a_k^* + z^{-1}}{1 - a_k z^{-1}}.
  \end{equation*}\]</div>
<p>For example, the frequency shifting by <span class="math notranslate nohighlight">\(\pi\)</span> considered in
<a class="reference internal" href="linphase.html#sec-freqtrans"><span class="std std-numref">Section 6.5.4</span></a> corresponds to the mapping <span class="math notranslate nohighlight">\(z^{-1} \mapsto
G(z^{-1}) = - z^{-1}\)</span>.</p>
</li>
<li><p>Other useful mappings of this form are summarized in the table
below. The listed mappings can be employed to convert a lowpass IIR
filter with passband edge frequency <span class="math notranslate nohighlight">\(\hat\omega_p\)</span> to another lowpass
filter, a highpass filter, a bandpass filter, and a bandstop filter, respectively.</p>
<table class="table">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>New filter type</p></th>
<th class="head"><p>New band edge(s)</p></th>
<th class="head"><p>Transformation</p></th>
<th class="head"><p>Parameter(s)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Lowpass</p></td>
<td><p><span class="math notranslate nohighlight">\(\hat\omega'_p\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle z^{-1} \mapsto \frac{-a + z^{-1}}{1-az^{-1}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle a 
= \frac{\sin\frac{\hat\omega_p - \hat\omega'_p}{2}}{
\sin\frac{\hat\omega_p + \hat\omega'_p}{2}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Highpass</p></td>
<td><p><span class="math notranslate nohighlight">\(\hat\omega'_p\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle z^{-1} \mapsto -\frac{-a + z^{-1}}{1-az^{-1}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle a 
= \frac{\cos\frac{\hat\omega_p + \hat\omega'_p}{2}}{
\cos\frac{\hat\omega_p - \hat\omega'_p}{2}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Bandpass</p></td>
<td><p><span class="math notranslate nohighlight">\(\hat\omega_l, \hat\omega_u\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle z^{-1} \mapsto
-\frac{a_2-a_1z^{-1}+z^{-2}}{1-a_1z^{-1}+a_2z^{-2}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\begin{align*} 
a_1 &amp;= \frac{2\alpha K}{K+1}
\\
a_2 &amp;= \frac{K-1}{K+1}
\\
\alpha &amp;= \frac{\cos\frac{\hat\omega_u + \hat\omega_l}{2}}{
\cos\frac{\hat\omega_u - \hat\omega_l}{2}}
\\
K &amp;= \cot\frac{\hat\omega_u - \hat\omega_l}{2} \tan
\frac{\hat\omega_p}{2}
\end{align*}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Bandstop</p></td>
<td><p><span class="math notranslate nohighlight">\(\hat\omega_l, \hat\omega_u\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle z^{-1} \mapsto
\frac{a_2-a_1z^{-1}+z^{-2}}{1-a_1z^{-1}+a_2z^{-2}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\begin{align*} 
a_1 &amp;= \frac{2\alpha}{K+1}
\\
a_2 &amp;= \frac{1-K}{1+K}
\\
\alpha &amp;= \frac{\cos\frac{\hat\omega_u + \hat\omega_l}{2}}{
\cos\frac{\hat\omega_u - \hat\omega_l}{2}}
\\
K &amp;= \tan\frac{\hat\omega_u - \hat\omega_l}{2} \tan
\frac{\hat\omega_p}{2}
\end{align*}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The MATLAB functions <code class="docutils literal notranslate"><span class="pre">iirlp2??</span></code> implement the frequency transformations
in the table above.</p>
</li>
<li><p><strong>MATLAB Example 12</strong>:</p>
<p>We apply the bandpass transformation to obtain a bandpass IIR filter
with passband <span class="math notranslate nohighlight">\([0.5\pi, 0.7\pi]\)</span> from the lowpass IIR filter in Example 9 above:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.01</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Rs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="mf">0.001</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1ord</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">Rs</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">b11</span><span class="p">,</span><span class="w"> </span><span class="n">a11</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">iirlp2bp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="w"> </span><span class="mf">0.7</span><span class="p">]);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fvtool</span><span class="p">(</span><span class="n">b11</span><span class="p">,</span><span class="w"> </span><span class="n">a11</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Note that since the frequency transformation maps the unit circle
onto itself, the specifications of <span class="math notranslate nohighlight">\(\delta_1\)</span> and <span class="math notranslate nohighlight">\(\delta_2\)</span> are
perserved. However, as the transformation may include frequency
shifting and scaling, the width of the transition bands may not be
the same as that of the original filter. In addition, the order of
the transformed filter may also be larger than that of the original
filter.</p>
</div>
<p>In this example, the transformed filter has order <span class="math notranslate nohighlight">\(N=32\)</span>, which is
higher than that of the filter obtained in Example 11. We can also
check that the width of transition bands is smaller than that of the
filter in Example 11.</p>
</li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ch6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="firdesign.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6.6. </span>FIR Filter Design</p>
      </div>
    </a>
    <a class="right-next"
       href="../ch7/multirate.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">&lt;no title&gt;</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prototype-analog-filters">6.7.1. Prototype Analog Filters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#butterworth-filter">6.7.1.1. Butterworth Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-i-chebyshev-filter">6.7.1.2. Type-I Chebyshev Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-ii-chebyshev-filter">6.7.1.3. Type-II Chebyshev Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#elliptic-filter">6.7.1.4. Elliptic Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analog-filter-design">6.7.1.5. Analog Filter Design</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#impulse-invariance-method">6.7.2. Impulse Invariance Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bilinear-transform-method">6.7.3. Bilinear Transform Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-transformation-of-iir-filters">6.7.4. Frequency Transformation of IIR filters</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tan F. Wong
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>